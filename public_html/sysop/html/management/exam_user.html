
<table class="c_tb01" cellpadding="0" cellspacing="0">
<tr>
	<td class="c_th01">응시자정보</td>
	<td class="c_td01"></td>
</tr>
</table>

<form name="form1" method="get">
<input type="hidden" name="ord" value="{{ord}}">
<input type="hidden" name="eid" value="{{eid}}">
<input type="hidden" name="cid" value="{{cid}}">
<input type="hidden" name="mode" value="">

<table class="t_tb01" cellpadding="0" cellspacing="0" style="table-layout:fixed">
<col width="120"><col><col width="120"><col>
<tr>
	<td class="t_th01">응시/제출 상태</td>
	<td class="t_td01">
		<label><input type="radio" name="s_submit_yn" value="Y" class="ipt01"> 제출자 </label>&nbsp;
		<label><input type="radio" name="s_submit_yn" value="N" class="ipt01"> 미제출자 </label>&nbsp;
		<label><input type="radio" name="s_submit_yn" value="F" class="ipt01"> 미응시자 </label>&nbsp;
	</td>
	<td class="t_th01">평가여부</td>
	<td class="t_td01">
		<label><input type="radio" name="s_confirm_yn" value="" class="ipt01" checked> 전체 </label>&nbsp;
		<label><input type="radio" name="s_confirm_yn" value="Y" class="ipt01"> 평가완료 </label>&nbsp;
		<label><input type="radio" name="s_confirm_yn" value="N" class="ipt01"> 미평가 </label>&nbsp;
	</td>
</tr>
<tr>
	<td class="t_th01">회원상태</td>
	<td class="t_td01">
		<label><input type="radio" name="s_out_yn" value="" class="ipt01" checked="checked"> 삭제회원제외 </label> &nbsp;
		<label><input type="radio" name="s_out_yn" value="Y" class="ipt01"> 삭제회원포함 </label> &nbsp;
	</td>
	<td class="t_th01">수강생상태</td>
	<td class="t_td01">
		<label><input type="radio" name="s_delete_yn" value="" class="ipt01" checked="checked"> 삭제수강생제외 </label> &nbsp;
		<label><input type="radio" name="s_delete_yn" value="Y" class="ipt01"> 삭제수강생포함 </label> &nbsp;
	</td>
</tr>
<tr>
	<td class="t_th01">검색</td>
	<td class="t_td01" colspan="3">
		<select name="s_field" onchange="document.forms['form1']['s_keyword'].focus();">
			<option value=""> - 전체 - </option>
			<option value="c.user_nm">회원명</option>
			<option value="c.login_id">회원아이디</option>
		</select>
		<input type="text" name="s_keyword" size="30" onfocus="this.select();">
		<button type="submit" class="bttn2">검색</button>
		
	</td>
</tr>
</table>

<table class="a_tb01" cellpadding="0" cellspacing="0" border="0">
<tr>
	<td class="a_th01">
		{{list_total}} &nbsp;
		<select name="s_listnum" onchange="this.form.submit();">
			<option value="20">20</option>
			<option value="50">50</option>
			<option value="100">100</option>
		</select> 건씩 보기
	</td>
	<td class="a_td01">
		<!--@if(confirm_block)-->
		<button type="button" class="bttn2 blue" onclick="printExamUser();">시험결과출력</button>
		<!--/if(confirm_block)-->
		<!--@if(offline_block)-->
		<button type="button" class="bttn2 blue" onclick="OpenWindows('exam_user_add.jsp?eid={{eid}}&cid={{cid}}', '_EXA01', 760, 530);">응시자 추가</button>
		<!--/if(offline_block)-->
		<button type="button" class="bttn2" onclick="sendMailUser();">메일발송</button>
		<!--@nif(SYS_BLINDUSER)-->
		<button type="button" class="bttn2" onclick="sendSmsUser();">SMS발송</button>
		<!--/nif(SYS_BLINDUSER)-->
		<button type="button" class="bttn2" onclick="sendMessageUser();">쪽지발송</button>
		<button type="button" class="bttn2" onclick="goExcel();">EXCEL</button>
		<button type="button" class="bttn2" onclick="setConfirmUser();">제출처리</button>
		<!--/if(dis_block)-->
	</td>
</tr>
</table>
</form>
{{form_script}}

<form name="form2" method="post">
<input type="hidden" name="mode" value="">
<input type="hidden" name="eu_idx" value="">
<table class="l_tb01" cellpadding="0" cellspacing="0" style="table-layout:fixed">
<colgroup>
<col width="50">
<col width="110">
<col width="110">
<col>
<col width="110">
<col width="110">
<col width="80">
<col width="90">
<col width="90">
<col width="60">
<col width="30">
</colgroup>
<thead>
<tr align="center">
	<td class="l_th03">No</td>
	<td class="l_th03"><span class="l_sort01" id="CL_c.user_nm" onclick="ListSort(this, '{{ord}}')">회원명</span></td>
	<td class="l_th03"><span class="l_sort01" id="CL_c.login_id" onclick="ListSort(this, '{{ord}}')">회원아이디</span></td>
	<td class="l_th03"><span class="l_sort01" id="CL_b.reg_date" onclick="ListSort(this, '{{ord}}')">응시일시</span></td>
	<td class="l_th03"><span class="l_sort01" id="CL_b.marking_score" onclick="ListSort(this, '{{ord}}')">취득점수</span></td>
	<td class="l_th03"><span class="l_sort01" id="CL_b.marking_score" onclick="ListSort(this, '{{ord}}')">환산점수</span></td>
	<td class="l_th03">평가하기</td>
	<td class="l_th03">응시취소</td>
	<td class="l_th03"><span class="l_sort01" id="CL_b.confirm_yn" onclick="ListSort(this, '{{ord}}')">평가여부</span></td>
	<td class="l_th03">이탈횟수</td>
	<td class="l_th03"><input type="checkbox" onclick="AutoCheck('form2', 'idx')"></td>
</tr>
</thead>
<tbody>
<!--@loop(list)-->
<tr class="l_tr_{{list.ROW_CLASS}}" align="center">
	<td class="l_td01">{{list.__ord}}</td>
	<td class="l_td01">{{list.user_nm}}</td>
	<td class="l_td01" align="left"><span class="crm" _id="{{list.u_id}}">{{list.login_id}}</span></td>
	<td class="l_td01">{{list.reg_date_conv}}</td>
	<td class="l_td01" align="right">
		<!--@nif(mod_block)-->
		{{list.marking_score_conv}}점 
		<!--/nif(mod_block)-->
		<!--@if(mod_block)-->
		<input type="text" id="marking_score_{{list.id}}" name="marking_score" value="{{list.marking_score_conv}}" size="3" onkeyup="setMax(this, 100)" class="ipt_right">
		<!--/if(mod_block)-->
		/ <span class="fontsmall">100점</span>
	</td>
	<td class="l_td01" align="right">{{list.score_conv}}점 / <span class="fontsmall">{{exam.assign_score}}점</span></td>
	<td class="l_td01">
		<!--@if(confirm_block)-->
		<!--@nif(mod_block)-->
		<input type="button" value="평가하기" class="btn_simp green" onclick="OpenWindows('exam_user_view.jsp?eid={{list.exam_id}}&cuid={{list.id}}', '', 760, 710)">
		<!--/nif(mod_block)-->
		<!--@if(mod_block)-->
		<input type="button" value="평가하기" class="btn_simp green" onclick="markItem('{{list.id}}')">
		<!--/if(mod_block)-->
		<!--/if(confirm_block)-->
		<!--@nif(confirm_block)-->-<!--/nif(confirm_block)-->
	</td>
	<td class="l_td01">
		<!--@if(delete_block)-->
		<input type="button" value="응시취소" class="btn_simp" onclick="delMark('{{list.id}}');">
		<!--/if(delete_block)-->
		<!--@nif(delete_block)-->-<!--/nif(delete_block)-->
	</td>
	<td class="l_td01">{{list.confirm_conv}}</td>
	<td class="l_td01">{{list.blur_cnt}} 회</td>
	<td class="l_td01"><input type="checkbox" name="idx" value="{{list.u_id}}" cuid="{{list.id}}" /></td>
</tr>
<!--/loop(list)-->
</tbody>
</table>
<!--@nif(list)-->
<table class="n_tb01" cellpadding="0" cellspacing="0">
<tr>
	<td>해당 수강생이 없습니다.</td>
</tr>
</table>
<!--/nif(list)-->
</form>
<!-- /List Area -->

<table class="p_tb01" cellpadding="0" cellspacing="0">
<tr>
	<td class="p_td01">{{pagebar}}</td>
</tr>
</table>

<form name="form3" method="post" target="sysfrmblank">
<input type="hidden" name="mode" value="mod">
<input type="hidden" name="cuid">
<input type="hidden" name="score">
</form>

<script language="JavaScript">
var f2 = document.forms['form2']
function sendMailUser() {
	if(!checkUser()) { alert("선택된 수강생이 없습니다."); return; };
	if(confirm("메일을 발송하시겠습니까?")) {
		OpenWindows('about:blank', 'SM001', 820, 795);
		f2.target = "SM001";
		f2.action = "pop_mail.jsp?cid={{cid}}";
		f2.submit();
	}
}
function sendMessageUser() {
	if(!checkUser()) { alert("선택된 수강생이 없습니다."); return; };
	if(confirm("쪽지를 발송하시겠습니까?")) {
		OpenWindows('about:blank', 'SM001', 720, 605);
		f2.target = "SM001";
		f2.action = "pop_message.jsp?cid={{cid}}";
		f2.submit();
	}
}
function sendSmsUser() {
	if(!checkUser()) { alert("선택된 수강생이 없습니다."); return; };
	if(confirm("SMS을 발송하시겠습니까?")) {
		OpenWindows('about:blank', 'SM001', 535, 530);
		f2.target = "SM001";
		f2.action = "pop_sms.jsp?cid={{cid}}";
		f2.submit();
	}
}

function checkUser() {
	var el = document.getElementsByName("idx");
	if(!el) return false;
	var isValue = false;
	for(var i=0; i<el.length; i++) {
		if(el[i].checked) { isValue = true; break; }
	}
	return isValue;
}

function setConfirmUser() {
	var el = document.getElementsByName("idx");
	if(!el) return;
	var tmpArr = new Array();
	for(var i = 0; i < el.length; i++) {
		if(el[i].checked) tmpArr.push(el[i].getAttribute("cuid"));
	}
	var idx = tmpArr.join(",");
	if(idx == "") {
		alert("선택된 수강생이 없습니다.");
		return;
	}
	if(confirm("제출 처리하시겠습니까?")) {
		f2.target = "sysfrmblank";
		f2.action = "exam_user.jsp?{{list_query}}";
		f2['mode'].value = "mark";
		f2['eu_idx'].value = idx;
		f2.submit();
	}
}
function delMark(cuid) {
	if(confirm("응시 취소하시겠습니까?")) {
		sysfrmblank.location.href = "exam_user.jsp?mode=cancel&cuid=" + cuid + "&{{list_query}}";
	}
}

function markItem(cuid) {
	var f = document.forms['form3'];
	var score = document.getElementById("marking_score_" + cuid).value;
	if(score == "") {
		alert("취득점수를 입력하세요.");
		document.getElementById("marking_score_" + cuid).focus();
		return;
	}
	f['cuid'].value = cuid;
	f['score'].value = score;
	f.submit();
}

function setMax(el, assign) {
	el.value = el.value.replace(/[^0-9\.]+/gi, '');
	if(el.value * 1 > assign) {
		el.value = assign;
	}
}

function printExamUser() {
	var el = document.getElementsByName("idx");
	if(!el) return "";
	var tmpArr = new Array();
	for(var i=0; i<el.length; i++) if(el[i].checked == true) tmpArr.push(el[i].getAttribute("cuid"));
	var idx = tmpArr.join(",");

	if(!idx) { alert("선택된 수강생이 없습니다."); return; };
	if(confirm("시험결과를 출력하시겠습니까?")) {
		OpenWindows('exam_user_print.jsp?eid={{eid}}&cid={{cid}}&idx=' + idx, '_EXP01', 760, 710);
	}
}

addEvent("onload", init);
function init() {
	ResizeIframe('userArea');
	setCRM();
	ListSort(null, "{{ord}}");

	$("form[name=form1] input[type=radio]").on("click", function() {
		document.forms['form1'].submit();
	});
}
</script>