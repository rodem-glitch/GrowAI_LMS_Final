server:
  port: 8081
  error:
    # 왜: 에러 응답에 stacktrace가 포함되면 민감정보(키/시크릿/경로)가 노출될 수 있어 차단합니다.
    include-stacktrace: never
    include-exception: false

spring:
  config:
    # 왜: 개인 PC별(DB/키) 설정을 Git에 올리지 않기 위해 local 파일을 선택적으로 불러옵니다.
    # - `application-local.yml`은 .gitignore로 제외하고, 각자 환경에 맞게 작성합니다.
    import: optional:classpath:application-local.yml
  application:
    name: polytech-lms-api
  datasource:
    # 왜: DB 비밀번호는 코드에 두지 않고(프라이빗 Git이어도) 환경변수로 주입하는 게 안전합니다.
    # - 로컬 개발은 .env(IDE Run Configuration) 또는 OS 환경변수로 설정해 주세요.
    url: ${DB_URL:jdbc:mysql://localhost:3306/lms?useSSL=false&allowPublicKeyRetrieval=true}
    username: ${DB_USERNAME:lms}
    password: ${DB_PASSWORD:}
  jpa:
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        format_sql: true

  ai:
    # 왜: 추천(유사도 검색)은 "임베딩 모델 + 벡터 DB" 조합이 표준입니다.
    # - 임베딩: Google GenAI (API Key 방식)
    # - 벡터 DB: Qdrant
    model:
      embedding:
        text: google-genai
    google:
      genai:
        embedding:
          api-key: ${GOOGLE_API_KEY:}
          text:
            options:
              model: ${GOOGLE_EMBEDDING_MODEL:text-embedding-004}
              task-type: ${GOOGLE_EMBEDDING_TASK:RETRIEVAL_DOCUMENT}
    vectorstore:
      qdrant:
        host: ${QDRANT_HOST:localhost}
        port: ${QDRANT_GRPC_PORT:6334}
        api-key: ${QDRANT_API_KEY:}
        collection-name: ${QDRANT_COLLECTION:video_summary_vectors}
        use-tls: ${QDRANT_USE_TLS:false}
        initialize-schema: ${QDRANT_INIT_SCHEMA:true}

kosis:
  # 왜: KOSIS(통계청) API 키/시크릿은 Git에 올리지 않고 환경변수로 주입합니다.
  # - Windows(PowerShell) 예) `$env:KOSIS_CONSUMER_KEY="..." ; $env:KOSIS_CONSUMER_SECRET="..."`
  consumer-key: ${KOSIS_CONSUMER_KEY:}
  consumer-secret: ${KOSIS_CONSUMER_SECRET:}
  # 왜: 운영/개발 환경에 따라 엔드포인트가 바뀔 수 있어 외부 주입 가능하게 둡니다.
  auth-url: ${KOSIS_AUTH_URL:https://sgisapi.mods.go.kr/OpenAPI3/auth/authentication.json}
  population-url: ${KOSIS_POPULATION_URL:https://sgisapi.mods.go.kr/OpenAPI3/stats/searchpopulation.json}
